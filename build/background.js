!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=191)}({191:function(e,t,r){"use strict";r.r(t);var o=r(8),n=r.n(o);const a={loaded:!1,bookmarks:[]};async function i(){const[e,t]=await Promise.all([n.a.bookmarks.getTree(),n.a.storage.local.get({bookmarks:[],visited:[]})]),r=new Set(t.bookmarks),o=new Set(t.visited),i=[];return function e(t,r,o=null){for(const n of t)r(n,o),Array.isArray(n.children)&&e(n.children,r,n)}(e,(e,t)=>{e.url&&(r.has(e.id)||r.has(t&&t.id))&&(r.add(e.id),i.push({id:e.id,title:e.title,url:e.url,visited:o.has(e.id)}))}),a.bookmarks=i,a.loaded=!0,a.bookmarks}function s(){if(a.loaded||i(),a.bookmarks.every(e=>e.visited))for(const e of a.bookmarks)e.visited=!1;const e=a.bookmarks.filter(e=>!e.visited),t=e[Math.floor(Math.random()*e.length)];return null!=t&&(t.visited=!0),n.a.storage.local.set({visited:a.bookmarks.filter(e=>e.visited).map(e=>e.id)}).catch(console.error),t}var c=r(5);chrome.webRequest.onBeforeRequest.addListener(e=>{if("GET"===e.method&&"main_frame"===e.type&&c.d()!==c.a.DISABLED&&c.b(e.url)){if(c.d()===c.a.ADDRESS_BAR)return;return{cancel:!0}}},{urls:["<all_urls>"]},["blocking"]),chrome.webNavigation.onBeforeNavigate.addListener(async e=>{if(c.d()===c.a.ALL&&c.b(e.url)){const t=s();t&&!c.b(t.url)&&await n.a.tabs.update(e.tabId,{url:t.url})}}),chrome.webNavigation.onCommitted.addListener(e=>{if(0===e.frameId&&c.d()===c.a.ADDRESS_BAR&&e.transitionQualifiers.includes("from_address_bar")&&c.b(e.url)){const t=s();t&&n.a.tabs.update(e.tabId,{url:t.url})}}),chrome.browserAction.onClicked.addListener(async e=>{chrome.runtime.openOptionsPage()}),chrome.bookmarks.onCreated.addListener(i),chrome.bookmarks.onChanged.addListener(i),chrome.bookmarks.onMoved.addListener(i),chrome.bookmarks.onRemoved.addListener(i),chrome.storage.onChanged.addListener(async e=>{e.bookmarks&&await i(),(e.blacklist||e.blacklistMode)&&await c.c()}),c.c(),i(),chrome.runtime.onMessage.addListener(async(e,t,r)=>{if("loadBookmark"===e.type){r();const e=s();e?await n.a.tabs.update(t.tab.id,{url:e.url}):await n.a.tabs.update(t.tab.id,{url:"chrome-search://local-ntp/local-ntp.html"})}})},48:function(e,t,r){
/*!
 * chrome-promise
 * https://github.com/tfoxy/chrome-promise
 *
 * Copyright 2015 TomÃ¡s Fox
 * Released under the MIT license
 */
!function(t,r){e.exports=function(e){"use strict";var t=Array.prototype.slice,r=Object.prototype.hasOwnProperty;return o.default=o,o;function o(n){var a=(n=n||{}).chrome||e.chrome,i=n.Promise||e.Promise,s=a.runtime,c=this;if(!c)throw new Error("ChromePromise must be called with new keyword");function l(e,r){return function(){var o=t.call(arguments);return new i((function(n,a){o.push((function(){var e=s.lastError,r=t.call(arguments);if(e)a(e);else switch(r.length){case 0:n();break;case 1:n(r[0]);break;default:n(r)}})),e.apply(r,o)}))}}function d(e,t){for(var n in e)if(r.call(e,n)){var a;try{a=e[n]}catch(e){continue}var i=typeof a;"object"!==i||a instanceof o?t[n]="function"===i?l(a,e):a:(t[n]={},d(a,t[n]))}}d(a,c),a.permissions&&a.permissions.onAdded.addListener((function(e){if(e.permissions&&e.permissions.length){var t={};e.permissions.forEach((function(e){var r=/^[^.]+/.exec(e);r in a&&(t[r]=a[r])})),d(t,c)}}))}}(this||t)}("undefined"!=typeof self?self:this)},5:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"d",(function(){return l}));var o=r(8),n=r.n(o);const a={ALL:"all",DISABLED:"disabled",ADDRESS_BAR:"address-bar"},i={blocked:[],mode:a.DISABLED};async function s(){const{blacklist:e,blacklistMode:t}=await n.a.storage.local.get({blacklist:"",blacklistMode:a.DISABLED});return i.mode=t,t!==a.DISABLED?i.blocked=String(e).split("\n").map(e=>e.trim()).filter(Boolean).map(e=>{try{return new RegExp(e)}catch(e){return null}}).filter(Boolean):i.blocked=[],i.blocked}function c(e){return i.blocked.some(t=>t.test(e))}function l(){return i.mode}},8:function(e,t,r){var o=new(r(48));o.default=o,e.exports=o}});
//# sourceMappingURL=background.js.map